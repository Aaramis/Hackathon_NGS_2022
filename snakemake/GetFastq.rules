__threads_GF = config["GetFastq"]["threads"]
__version_GF = config["GetFastq"]["version"]
__container_GF = "./" + config["GetFastq"]["container"]
__params_GF_Repertory = config["GetFastq"]["Repertory"]

#####

rule GetFastq : 
  params :
    id = __params_GF_NCBI_id,
    test = __container_GF,
    repertory = __params_GF_Repertory,
  
  output :
    fastq_1 = __output_GF_Fastq1,
    fastq_2 = __output_GF_Fastq2
  
  message :
    "GetFastq with sra toolkit for {params.id} NCBI_id"
  
  threads :
    __threads_GF
  
  version :
    __version_GF
  
  singularity :
    __container_GF
  
  log :
    out = __stdout_GF,
    err = __stderr_GF

  shell :
    "prefetch -f yes {params.id} 1>{log.out} 2>{log.err}; \
    fasterq-dump {params.id}/{params.id}.sra 1>{log.out} 2>{log.err}; \
    if ! test -d ./{params.repertory}{params.id}_1; then \
      mkdir ./{params.repertory}{params.id}_1; \
    fi; \
    if ! test -d ./{params.repertory}{params.id}_2; then \
      mkdir ./{params.repertory}{params.id}_2; \
    fi; \
    mv {params.id}_1.fastq {params.repertory}{params.id}_1/{params.id}_1.fastq 1>{log.out} 2>{log.err}; \
    mv {params.id}_2.fastq {params.repertory}{params.id}_2/{params.id}_2.fastq 1>{log.out} 2>{log.err}; \
    rm -rf {params.id}"

#        if test -f ./{params.id}.fastq ; then mv {params.id}.fastq {params.repertory}{params.id}.fastq 1>{log.out} 2>{log.err}; \
#    fi; \
#    if test -f ./{params.id}_1.fastq ; then mv {params.id}_1.fastq {params.repertory}{params.id}_1.fastq 1>{log.out} 2>{log.err}; \
#    fi; \
#    if test -f ./{params.id}_2.fastq ; then mv {params.id}_2.fastq {params.repertory}{params.id}_2.fastq 1>{log.out} 2>{log.err}; \
#    fi; \
#     gzip {params.repertory}{params.id}_1.fastq {params.repertory}{params.id}_2.fastq; \
